<!DOCTYPE html>
<html>
	<head>
 		<!-- Create table -->
		<script type="text/javascript">
		
			function KurstabelleZeichnen(suchstring) {
				$.ajax({
					url: "/report/toverview/rest/router.php/course/?query=" + suchstring,
					dataType: 'json',
				}).done(function (result) {
					// Create and populate the data table.
					var data = new google.visualization.DataTable();
					data.addColumn('number', 'ID');
			        data.addColumn('string', 'Semester');
			        data.addColumn('string', 'FB');
			        data.addColumn('string', 'Name');
			        var array = new Array();
			        result = result.Records;
			        //console.log(result);
        	    	$.each(result, function(id, felder) {
        	    		console.log(felder);
        	    		
        	    		var subarray = new Array();
        	    		subarray.push(parseInt(felder.id));
        	    		subarray.push(felder.semester);
        	    		subarray.push(felder.fb);
        	    		subarray.push(felder.fullname);
        	    		//data.addRow(array);
        				//data.addRow('boolean', eigenschaften.bezeichnung);
        				array.push(subarray);
        			});
        	    	data.addRows(array);
        	    	
        	    	// Create and draw the visualization.
			        var table = new google.visualization.Table(document.getElementById('courses'));
			        table.draw(data, {showRowNumber: false});
			        
			        // Setup listener
			        google.visualization.events.addListener(table, 'select', selectHandler);
			        
			        // Select Handler. Call the table's getSelection() method
			        function selectHandler() {
			        	var selection = table.getSelection();
			        	//alert("That's row " + data.getValue(selection[0].row, 0))
			        	$.get("/report/toverview/html/detailed_course_view.html", function( inhalt ) {
	    					var x = data.getValue(selection[0].row, 0);
	    					//console.log(x);
	    					inhalt = inhalt.replace(/#ID#/g, x);
	    					//console.log(inhalt);
	    					$( "#getCourse" ).html(inhalt);
	    					$('body,html').animate({scrollTop:0},800);
			        	})
			        }   
				});
			}
			
	    	$(document).ready(function () {
    			$( "#search" ).keyup(function() {
				  KurstabelleZeichnen($( this ).val());
				});
        	});
		</script>
	</head>

	<body>
		<div class="row">
			<div class="col-md-6">
				<div>
					Kurs suchen:
	        		<input id="search"></input>
	        	</div>
	    	</div>
		</div>
	
		<div class="row">
			<div class="col-md-6">
	        	<div id="courses"></div>
	        </div>
	        <div class="col-md-6">
				<div id = "getCourse"></div>
	    	</div>
		</div>
	</body>
</html>